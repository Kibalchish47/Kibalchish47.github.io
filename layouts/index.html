{{/* layouts/index.html */}}
{{ define "main" }}
<div class="homepage-content-wrapper pt-2 md:pt-4"> {{/* Add some top padding if needed */}}
    {{/* This single line will render everything from your content/_index.md, including all shortcode outputs */}}
    {{ .Content }}
</div>
{{ end }}

{{ define "scripts_extra" }}
    {{/* Any JavaScript specifically needed for elements generated by shortcodes
      on the homepage (e.g., a carousel if you add one later) would go here.
      The global navigation link highlighting script is in baseof.html.
    */}}
{{ end }}

{{ define "scripts_extra" }}
<script>
    // Simple hash-based section toggling for About/Contact on homepage
    function showSectionBasedOnHash() {
        const sections = document.querySelectorAll('#homepage-content > section');
        const navLinks = document.querySelectorAll('header nav a');
        let targetId = window.location.hash ? window.location.hash.substring(1) : 'about'; // Default to 'about'

        // If navigating to a section not on this page (e.g. blog link clicked from blog page), do nothing here.
        // This script is primarily for #about and #contact on the homepage.
        if (targetId !== 'about' && targetId !== 'contact') {
             // If it's not about or contact, make sure about is shown by default if no other logic applies
             if (!document.getElementById(targetId) || !document.getElementById(targetId).closest('#homepage-content')) {
                targetId = 'about';
             }
        }


        let sectionToShow = document.getElementById(targetId);

        sections.forEach(section => {
            if (section.id === targetId && section.closest('#homepage-content')) {
                section.classList.remove('hidden');
            } else if (section.closest('#homepage-content') && (section.id === 'about' || section.id === 'contact')) {
                // Only hide about/contact if they are not the target
                section.classList.add('hidden');
            } else {
                // Non-about/contact sections on homepage are always visible (they are just links)
                section.classList.remove('hidden');
            }
        });

        // If after hiding, the target section (about/contact) isn't found or visible, default to showing 'about'
         if (!sectionToShow || sectionToShow.classList.contains('hidden') && (targetId === 'about' || targetId === 'contact')) {
            document.getElementById('about')?.classList.remove('hidden');
            targetId = 'about';
        }


        navLinks.forEach(link => {
            link.classList.remove('active', 'text-custom-red-500', 'font-semibold', 'bg-custom-red-200');
            link.classList.add('text-custom-gray-700');
            if (link.getAttribute('href').endsWith('#' + targetId)) {
                link.classList.add('active', 'text-custom-red-500', 'font-semibold', 'bg-custom-red-200');
                link.classList.remove('text-custom-gray-700');
            }
        });
    }

    // Initial call
    window.addEventListener('DOMContentLoaded', showSectionBasedOnHash);
    // Update on hash change
    window.addEventListener('hashchange', showSectionBasedOnHash);

    // Allow nav clicks to update hash and show section
    document.querySelectorAll('header nav a[href^="{{ "/" | relURL }}#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            const sectionId = this.getAttribute('href').split('#')[1];
            const targetSectionOnPage = document.getElementById(sectionId);
            if (targetSectionOnPage && targetSectionOnPage.closest('#homepage-content')) {
                // e.preventDefault(); // Only prevent default if staying on page
                window.location.hash = '#' + sectionId;
                // showSectionBasedOnHash will be triggered by hashchange or manually if needed
                if (window.location.pathname === '/' || window.location.pathname === '{{ "/" | relURL }}' || window.location.pathname === '{{ .Site.BaseURL | relURL }}index.html' ) {
                     // Call directly if hashchange doesn't fire consistently or for immediate feedback
                     showSectionBasedOnHash();
                }
            }
            // If link is to another page's section, let default behavior proceed
        });
    });
</script>
{{ end }}
